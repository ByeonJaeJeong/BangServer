package application;




import java.awt.Desktop.Action;
import java.net.Socket;
import java.net.URL;

import java.util.ResourceBundle;




import javafx.collections.FXCollections;
import javafx.collections.ListChangeListener;
import javafx.collections.ObservableList;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.control.TableColumn;
import javafx.scene.control.TableView;
import javafx.scene.control.TextField;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.Pane;

public class BangRoomController implements Initializable{
	Socket socket;
	
	@FXML
	TableView<Table> Roominfo= new TableView<Table>();
	
	public  ObservableList<Table> data=FXCollections.observableArrayList(
			new Table("1/8", "TEST", "¥Î±‚¡ﬂ"),
			new Table("1/8", "TEST2","¥Î±‚¡ﬂ")
			);
			
	@FXML
	private TableColumn<Table,String> inwonCol;
	@FXML
	private TableColumn<Table,String> titleCol;
	@FXML
	private TableColumn<Table,String> stateCol;
	@FXML
	private Button refreshBtn;
	
		

		
	
			
	
	


	
	@Override
	public void initialize(URL location, ResourceBundle resources) {
		  System.out.println("FXML Load Complete");
		  
		  Roominfo.setPlaceholder(new Label("Loding..."));
		inwonCol.setCellValueFactory(new PropertyValueFactory<Table,String>("inwon"));
		titleCol.setCellValueFactory(new PropertyValueFactory<Table,String>("title"));
		stateCol.setCellValueFactory(new PropertyValueFactory<Table,String>("state"));

		Roominfo.getItems().setAll(this.data);
		Roominfo.getItems().add(new Table("æ»≥Á", "æ»≥Á", "æ»≥Á"));
		
		refreshBtn.addEventFilter(MouseEvent.MOUSE_PRESSED, new EventHandler<MouseEvent>() {
			
			@Override
			public void handle(MouseEvent event) {
				// TODO Auto-generated method stub
				data.clear();
				Client.sendMsg("500|");
				System.out.println("initdata≈©±‚="+data.size());
				Roominfo.getItems().clear();
				data.add(new Table("inwon", "title", "state"));
				String[]ss= {"1/8--title","8/1--title"};
				addTable(ss, data);
				Roominfo.getItems().addAll(data);
				
			}
		});
		data.add(new Table("æ»≥Á", "æ»≥Á", "æ»≥Á"));
		

		
	}
	@FXML Pane addRoomPanel;
	@FXML
	public void addRoomBtn(){
		addRoomPanel.setVisible(true);
	}
	@FXML TextField title_input;
	@FXML TextField pass_input;
	@FXML
	public void addRoomcancel(){
		title_input.setText("");
		pass_input.setText("");
		addRoomPanel.setVisible(false);
	}
	@FXML
	public void addRoom(){
		String title_pass="160|"+title_input.getText()+"|"+pass_input.getText();
		
		addRoomPanel.setVisible(false);
		title_input.setText("");
		pass_input.setText("");
		
		Client.sendMsg(title_pass);
	}
	
	
	
	
	
	
	public void addTable(String[] Tables,ObservableList<Table> datas){

		
		System.out.println("addTableΩ««‡");
		for(int i=0;Tables.length>i;i++){
			
			String title=Tables[i].split("--")[0];
			String inwon=Tables[i].split("--")[1]+"/8";
			String state="¥Î±‚¡ﬂ";
			System.out.println("name="+title+"Inwon="+inwon);
			
			data.addAll(new Table(inwon, title, state));
			
		}
	
		System.out.println("data≈©±‚"+data.size());
		System.out.println("Ω««‡≥°");
		
		
		
		}
	}
	
}


